<!DOCTYPE html>
<html >
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<link rel="stylesheet" href="js/dojo/dijit/themes/claro/claro.css">	
	<script>dojoConfig = {parseOnLoad: true}</script>
	<script src='js/dojo/dojo/dojo.js'></script>	
	<script>
		dojo.require("dijit.dijit");
		require(["dojo/parser", "dijit/form/Form", "dijit/form/Button", "dijit/form/ValidationTextBox", "dijit/form/Select"]);
		require(["dojo/store/JsonRest","dojo/data/ObjectStore"]); 
        dojo.addOnLoad(function() {		
    		var userTypesStore = new dojo.store.JsonRest({
    			target: "getUserTypes.do",
				headers: {"Content-Type": "application/json"}, 
				idProperty: "id"
    		});
    		var userTypes = dijit.byId("type");
    		userTypes.set("store",dojo.data.ObjectStore({objectStore: userTypesStore}));
			userTypes.set("value", "$!user.type");
    		var saveUserBtn = dijit.byId("saveUserBtn");
    		dojo.connect(saveUserBtn, "onClick", null, function(evt) {
        		dojo.xhrPost({
                    url: "editUsersAction.do",
        			handleAs : "json",
        			form : "myForm",
		           	load: function(data){
	            		if(data["success"]){
							window.location.href = "userManagement.do";
	            		}else{
	            			alert(data["msg"]);
	            		}							            		
	            	},
	            	error: function(data){					            		
					}
                });
    		});
			var cancelBtn = dijit.byId("cancelBtn");
			dojo.connect(cancelBtn, "onClick", null, function(evt) {
				window.location.href = "userManagement.do";
    		});
        });
		function myFunction(url)
        {
        	window.location.href= url;
        }
	</script>
</head>
<body class="claro">
    <div data-dojo-type="dijit/form/Form" id="myForm" data-dojo-id="myForm" encType="multipart/form-data" action="addUsersAction.do" method="post">
	<table style="border: 1px solid #9f9f9f;" cellspacing="10">
		<tr>
            <td>
                <label for="type">用户类型:</label>
            </td>
            <td>
				<input data-dojo-type="dijit/form/Select" labelAttr="name" name="type" id="type" disabled/>
            </td>
        </tr>
        <tr>
            <td>
                <label for="account">用户名:</label>
            </td>
            <td>
                <input type="text" value="$!user.account" id="account" name="account" required="true" data-dojo-type="dijit/form/ValidationTextBox" readOnly/>
            </td>
        </tr>
        <tr>
            <td>
                <label for="name">名字:</label>
            </td>
            <td>
                <input type="text" value="$!user.name" id="name" name="name" required="true" data-dojo-type="dijit/form/ValidationTextBox"/>
            </td>
        </tr>
        <tr>
            <td>
                <label for="password">密码:</label>
            </td>
            <td>
                <input type="password" value="$!user.password" id="password" name="password" data-dojo-type="dijit/form/ValidationTextBox" disabled/>
            </td>
        </tr>
    </table>
    <button data-dojo-type="dijit/form/Button" type="button" id="saveUserBtn">保存</button>
	<button data-dojo-type="dijit/form/Button" type="button" id="cancelBtn">返回</button>
</div>
</body>
</html>